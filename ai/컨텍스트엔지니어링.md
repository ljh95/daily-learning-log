## AI 에이전트 성능 최적화를 위한 효과적ㅇ니 컨텍스트 엔지니어링

ai 에이전트 개발의 핵심 러다임이 단순한 프롬프트 엔지니어링에서 모델의 행공을 유도하는 모든 정보를 초괗ㄹ하는 컨텍스트 ㄹ엔지니어링으로 전환되고 있음을 조명함
AI에이전트는 작동하는 동안 유핞나 자원ㅇ니 주의력을효과적으로 사용해야하며
이를 위해 컨텍ㄱ스트를 신중하게ㅐ 관리하느것이 필수조ㅓㄱ임

본 문서는 고성은 ai에이전트 구축을 휘나 핵심전략과 구쳊거인 기술적 접근법을 제시하며 개발자가 더 신뢰성잇고 유능한 에이전트를 설꼐할 수 있도롤 돕는것을 목표로ㅓ마

## 1. 프롬프트 엔지이어링을 넘어서

지난 몇년간 응용 ai분양의 관심은 프롬프트 엔진니어링에 집중되엉씀
하지만 언어 모델을 활용한 개발 패러다임이 진화하면서 이제 단수순히 최적읜 단어나 문구를 찾는것을 넘어
어떤 컨텍스트 구성이 모델의 원하는 행동을 가장 효괒거으로 이끌어ㅏ낼것인가 라는 더 넓은 질문ㅇ레ㅐ ㄷ답하는것으로 초점이 이동됨

이런 변화의 중심에 컨테스트엔지니어링이 있음

2개념의 차이를 ㅕㅁㅇ확히 하느것이 중요

- 프롬프트 엔지니어링
  - 최상의 결괄르 얻기 위해 LLM에 제동되는 지침을 작성하고 구성하는 기술
  - 주로 시스템 프롬프틍를 어덯게 작성할것ㅇ니지 초점
- 컨텍스트 엔지니어링
  - 추론 과정 동ㅇ나 쵲거의 성능을 발휘할 수 잇도록 토큰의 집항르 선ㅈㅂ려하고ㅓ 유ㅜ지하기위하 모든 전략을 포괄함
  - 이는 시스템 지침뿐 아니라 도구외부 데이터, 메시지 기록들 프롬프트 외의 모든 정보를 포함하는 관범위하 ㄴ개념

가장 큰 차이점은 컨텍ㅌ스트 렌지니어링이 일회성 작업이 아니라는점
에이저느트 루프 안에서 자4ㄱ동하며 지속적으로 새로운 데이터를 생성함
이 정보는 다름 추론 단계와 관련이 있을 수 있으므로 제한된 컨텍스트 창에 무엇을 포함할지 반족ㅈ거이고 순환적인 과정을 통해 계쏘ㅓㄱ해서 정제되야함

## 2. 컨텍스트 엔지니어링의 중요소ㅓㅇ: 유하한 자원으로서의 주의력

LLM은 방대한 데이터를 처리할 수 있지만 그 능력에도 한계자 ㄱ존재하
인간이 작업기억 용량에 한계가 있는것처럼
LLM역시 주의역 예산 이라는 제약을 가짐
컨텍스트를 신중하게 괂리행하나 근본적인 이유가 여기에 있음

건초 더민에서 바늘 찾기 방식의 벤티마킹 연구를 통해
컨ㄱ텍스트 부패라는 현상이 발견ㅇ됨
이는 컨텡ㄹ스트 창에 포함된 토큰의 수가 즈아할 수 록 모델이 해당 컨텍스트내으이ㅏ특정 정볼르정화하게 최상하느 ㄴ능력이 감소하는 현상을 의미함

일부 모델이 다른 모델보다 성능저하가 더 와만하게 나타나긴하지만 이 특성은 모든 LLM에서 보편적으로 나타남
이러한 주의력 부족은 LLM의 구조적인 제약에서 비롯됨

1. 트랜스포머 아키텍처
   1. LLM의 기반이 되는 트랜스 포머 구조는
   2. 컨텍스트 내의 모든 토큰이 다른 모든 토큰에 주의을 ㄹ기울이도로 설계되어있ㅆ음
   3. 이는 n개의 토큰에 대해 n^2의 관계를 처리해아함ㅇ르 의미함
   4. 컨텍스트길이가 길어질 수록 이렇나 관계를 초락하느 몯렝의 능력이 저하될 수 밖에 없음
2. 학습 데이터 분포
   1. 모델은 일반적을 긴 시퀀스보다 짧은 시퀀스의 데이터를 더 많이 학습함
   2. 이는 모델이 컨텍스트 전반의 의존성처리에 특화된 파라미터를 상대적으로 적게 보유하게 됨을 의미
   3. 위치 인코딩 보간 과 같은 기술이 모델이 더 긴 시퀀스를 처리하도록 돕지만,
   4. 토크누 위치 이해도가 다소 저하되느 ㄴ단점이 있음
      이런 피할숭 벗느 아키텍처의 한계는 엔지니어륻ㄹ이 주의력 부족을 ㅕㅇㅁ두에 두고 적극적으로 시스템을 설계해야함ㅇ르 의미함
      즉, 컨텍스트 엔지니얼이을 더이상 선택이 아닌 고성능 에이전트 구축으 뤼힌 필수 요소임

## 3. 효과적인 컨텍스트의 구성 요소

효과적인 컨텍슿트 엔지니어링의 핵시 웜칙은 원하ㅣ느 결과ㅓ를 극대화하느 가장 작고 신호가 강한 토큰 집합을 찾는것임

### 3.1 시스템 프롬프트

시스템 프롬프트는 에이전트의 행동 지침을 담는 핵심 요소로 올바른 고도를 유지하는것이 중요함
이는 2가지 흔한 싪채 사례 사이 골디락스 존을 찾는것임

- 지나치게 구체적인 지침
  - 모든 상황을 가정한 경직된 if-else 놀리를 프롬프트에 하드코딩하느 방식
  - 이는 시스템을 취약하게 만드곡 유지보수를 어렵게함
- 지나치게 모호한 지침
  - 너무 광범위ㅎ하고 추상적인 지침은 모델에게 굴체적인 해동신호를 주지 못하거단 개발자와 모델간에 공ㅇㅎ되 ㄴ맥락이 잇나느 잘못된 가정을 하게 만듬

최적의 프롬프트는 행동으 효고핮거으로 유도할마틈 구체적이면서 모델ㅇ이 강려갛 휴리스틱을 바탕으로 유옇ㄴ하게 대처할 수 이$는여지르 남겨둠
또한 xml태그나 마크다운 헤더를 사요해 프롬프트를 구조홯하면 ㅎ명화석ㅇ으 높일 수 있음
프롬프트 개발을 위한 저희 팀의 ㄱ권장 플로은 다음과 같음
"가장 좋은 모델로 최소한의 프롬프트를 테스트하여 작업성느,ㅇ을 확싱ㄴ한 후 초기 테스트에서 발견된 실패 사례를 바타으로 명화하 지침과 옜를 추가하여 성능을 개선하는것이 좋음"

### 3.2 도구

도구는 에이전트가 외부 환경과 상호작용하고 새로운 컨테스트를 가져오는 통로임
다음 원칙을 따라야함

- 토큰 효율성: 도구는 간경하고 정보 밀도가 높은 결과르 반환해야함
- 명확산 사용 목적: 각 도구의 기능과 의도가 명확해야함
- 기능적 중복 최소화: 유사한 기능의 도구들이 중복되지 않도록 설꼐해야함
- 견고한 오추ㅠ처리: 예외적인 상황에서도 안정적으로 작동해야함
  가장 흔샇 실패 사례는 비대한 도구 세트임
  인간 엔지니어 조차 특정 상황에어 어떤 도구를 사용해야할지 확신이 ㅇ벗다면 ai에이저느가 더 잘해낼것이라고 기대할 ㅜㅅ 없음

### 3.3 예시

에이전트에게 기대한 해동ㅇ르 보여주는 예시를 ㄷ제ㄱ공하는 것으 매우 효괒거이 전략임
하지만 모든 간으헨 엣지 케이스느열하려응 시도는 비요류적ㅇ
대신 ㅇ에이전트의 기대행동으 ㄱ장 잘 ㅌ나타내는 다양하고 대표적인 예시 몇가지를 선별하여 제공하느것이 훨씬 중요함
LLM에게 잘 선택ㅈ된 예시는 좋음

결론적으로 정보는 풍부하게 하되 간결함을 유지하라임

## 4. 동적 컨텍스트 관리ㅣ 에이전트 기반 검색 전략

초기 ai애플리케이션은 임베딩 기반 검색을 ㅊ통해 추론 전에 필요한 정보를 미맂 가져오는 방식을 주로 사용함
하지만 최긍넨은 에이전트가 직접 ㅎ필요한 전ㅇ보를 실시간으로 탐색하는 적시 전략으로 팬러다임이 전화됨
Just in time 컨텍쇼ㅡ트 접근법은 에이전트가 파일 경로, 저장된 쿼리, 우웹 링크 등 가벼운 식별자만 유지하고 잇다가
필요할 떄 도구를 사용해 전체데이터를 동적으로 컨텍스트에 로드라하는 방식

이는 2가지 이점을 제공함

1. 효율저ㅗㄱ이 행동 정제:
   1. 파일명 폴더 구조, 타임스탬프와 같이
   2. 메타데이터는 그 자체로 에이전트에게 강력한 신호가 됨
   3. 에이전트는 이 정보를 바타응로 언제 어덯게 정볼르 활요할지 더 효유ㅜㄹ적으로 판단 가능
2. 점진적 정보 공개
   1. 에이전트는 탐새을 통해 점진적으로 관련 컨텍스트를 발견하고 현재 작업에 필수적이 ㄴ정보만 작업기억에 유지함
   2. 이를 토앻 불피룡한 정보의 홀수 속에서 길을 맇지 ㅇ낳고 문제에 집중 가능

물론 실쇼ㅣ간 탐색인 미리 계싼된 데이털르 가져오느 것보다 ㄷ=느릴 숭 ㅣㅆ음
따라서 일부 데이터를 미리 로드하고 필요에 따라 에이전트가 자율적으로 추가 탐색하는 하이브리드 전략이 효ㅈ과적임
예를 들어 Claude Code는 프로젝트 관련 정보가 담김 Clasude.md 파일을 미리 컨텍스트에 로드하는 ㅅ동시에 glob, grep head tail꽈 같은 abash명령어를 통해 실시간을 파일 시스템을 탐색함
이 방식은 대용량 데이터르 객체전체를 컨텍승트에 로들하지 ㅇ낳고도 내용을 분석할 수 있게 해주면 오랜 된 인덱싱ㅇ이나 복잡하 ㄴ구문 트리 무넺를 효좍어르ㅗ 후외함

## 5. 장기 과제 해결을 위한 고급 기법

장기 과제란 대귭모 코드 베이스 마이그레이션이나 포괄적이 ㄴ여ㅛ구 프로젝트 러첨
수행에 필요한 총 토큰 수가 LLM의 단일 컨텍스트 위도우크기를 촤과하는 작업ㅇ르 의미함
단수히 더 큰 컨텍스트 위돌르 기다리는것마느로는 컨텍스트오염 문제를 근볹거으로 행겨라할 숭 ㅓㅄ으므로 다음 기법이 필요함

### 5.1 압축

컨텍스트 위도우 한계를 가까워진 대화나 작업 내용을 요ㅎ약하여
그 요약본을 가지고 새로운 컨텍스트 윈도웅에서 작업을 계속하느 기법임

예를 들어 Claude Code는 모델에게 메시지 기록을 요약하도록 하여 가장 중요한 세부사항을 ㅏㅇㅂ축함
모델은 아키텍처결정 미해결 버그 , 구현 세부사항은 ㅁ보존하면서 중복됟는 ㄱ도구 추력리아ㅣ나 메시지를 퓨ㅖ기함
그 후 에이전트 는 이 압축된 ㅋㄴ텍쇼ㅡ트와 가장 최긍네 접귾 5개의 파일으 가지고 작업을 계쏙할 수 있음

### 5.2 구조화된 노트 필기

에이전트가 주기적으로 텈ㄴ텍스트 위도우 외부의 영구적인 메로이에 작업 진행 상황 주요 결정 상항드응ㄹ 기록하고 다시 불러오는 방시임
Claude개발자 플랫폼에서 공개 벹타로 제공되는 메뢰 도구도 이런 접근응ㄹ 지원함
이 기법의 위력은 포켓몬 게임 플레이한 에잊너트 사례에 명확히 드러남
에이전트는 이 기법을 사용해 수천 단계에 걸쳐 진행상황을 정화시 추적함

### 5.3 하위 에이전트 아키텍처

하나의 만능 에이전트 대쇼ㅣㄴ 여러 전문화된 하위 에이전트가 각자의 집중된 작업을 처리하고 그 ㄱ결과만 상위 에이전트에게 요약하여 보고하느 방식임
이를 통해 관심사의 분리를 달성할 ㅅ구 있음
각 하ㅣ위 에이전트는 수만개의 토큰을 사용해ㅐ 깊이 있느 탐색을 수행하더라도 상위 에이전트에게 1000~2000 토큰의 정데ㅈ되 요약만 전달함
이 구조는 복잡한 여구 괒에게서단잉 에지너트 시스템ㅂ3ㅗ더ㅏ 조흥ㅁ

각 기법의 적합성으 작업의 특성에 따랒 달라짐
압축은 지속적이 ㄴ상호작용의 연속성을 보존해야할 대화흐름에 이상적
구조화된 노트 필기는 명확한 이정표애ㅔㅔ 따라 상태를 추적하는것중요할 반복적 개발 작업에 탁월함
하위 에이전트 아키텍처는 주 에이전트 의 집중력을 오염시키지 않음면서 병렬 탐샛을 가능하세 하므로 복잡한 여구에 가장 우수함

## 6. 결론: 컨텍트스 중심의 ai 에이전트 구축

컨텍스트 엔지니어링은 LLM을 활용한 개바 방시겡 근볹거인 전화을 가져옴

이제 우리의 과ㅔ는 완벽한 프롬프틑를 작성하느것이 안리ㅏ 모델의 제한된 주의력 예산에 어떤 정보를 넣을지 신중하게 선별하는것임
